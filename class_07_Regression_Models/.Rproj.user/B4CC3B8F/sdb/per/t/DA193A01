{
    "contents" : "library(ggplot2)\nlibrary(dplyr)\ndata(mtcars)\n?mtcars\nmtcars=tbl_df(mtcars)\nmtcars\n\n\n\n\n# Is an automatic or manual transmission better for MPG?\nmtcars$Transmission=NA\nmtcars$Transmission[which(mtcars$am==0)]=\"Automatic\"\nmtcars$Transmission[which(mtcars$am==1)]=\"Manual\"\n\nmtcars %>% group_by(Transmission) %>% summarise(min(mpg),mean(mpg),median(mpg),max(mpg))\nt.test(data=mtcars,mpg~Transmission)\n\n\n\n\n\n\n\n  \n\n\n# Quantify the MPG difference between automatic and manual transmissions\nmostly_numeric_model=lm(mpg~Transmission+cyl+hp+disp+drat+wt+qsec,data=mtcars)\nsummary(mostly_numeric_model)\n\nstepwise_model=step(mostly_numeric_model,k=log(nrow(mtcars)))\nsummary(stepwise_model)\n\nanova(mostly_numeric_model,stepwise_model, test=\"Chi\")\n# The P-value is larger than 0.05. So, according to our criterion, \n# we would fail to reject the more simplified model,\n\n\n\ncategorical_fit=lm(mpg~Transmission,data=mtcars)\nsummary(categorical_fit)\n\nanova(stepwise_model, categorical_fit, test=\"Chi\")\n# The P-value is smaller than 0.05. So, according to our criterion, \n# we would reject the more simplified model,\n\n\nggplot(data=mtcars)+theme_bw()+geom_density(aes(x=mpg,color=Transmission))+\n  ggtitle(\"Fuel Efficiency by Transmission type\")+xlab(\"Miles Per Gallon (MPG)\")+ylab(\"Density\")\n\nggplot(data=mtcars)+theme_bw()+geom_point(aes(y=wt,x=mpg,color=Transmission))+\n  geom_smooth(method=lm,aes(y=wt,x=mpg,color=Transmission))+\n  ggtitle(\"Fuel Efficiency by Weight\")+ylab(\"Miles Per Gallon (MPG)\")+xlab(\"Weight\")\n\n\nqplot(fitted(stepwise_model),residuals(stepwise_model))+geom_hline(yintercept=0)+theme_bw()\nqqnorm(residuals(stepwise_model))\n\n\n\n ",
    "created" : 1438707483334.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3373293442",
    "id" : "DA193A01",
    "lastKnownWriteTime" : 1439831908,
    "path" : "~/Coursera_Data_Science_JH/class_07_Regression_Models/course_project.R",
    "project_path" : "course_project.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 0,
    "source_on_save" : false,
    "type" : "r_source"
}