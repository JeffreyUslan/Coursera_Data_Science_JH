return(filled)
}
imputed_activity <- activity
imputed_activity$steps <- mapply(Create, imputed_activity$steps, imputed_activity$interval)
imputed_activity$steps <- mapply(imputed_activity, imputed_activity$steps, imputed_activity$interval)
imputed_activity <- activity
imputed_activity$steps <- mapply(imputed_activity, imputed_activity$steps, imputed_activity$interval)
imputed_activity <- activity
imputed_activity
imputed_activity <- activity
imputed_activity$steps <- mapply(single_point_impute, imputed_activity$steps, imputed_activity$interval)
apply(imputed_activity,2,function(x){
sum(is.na(x))
})
summary(imputed_activity$steps)
summary(activity$steps)
summary(imputed_activity$steps)
class(imputed_activity$steps)
View(imputed_activity)
imputed_activity<-t(apply(activity,1,function(x){
if (is.na(x[1])){
ind=which(x[3]==mean_steps$interval)
x[1]=round(mean_steps$interval_steps[ind])
}
return(x)
}
))
imputed_activity<-t(apply(activity,1,function(x){
if (is.na(x[1])){
print(x)
ind=which(x[3]==mean_steps$interval)
x[1]=round(mean_steps$interval_steps[ind])
}
return(x)
}
))
x=activity[1,]
x
x[3]
which(x[3]==mean_steps$interval)
activity$interval=as.factor(activity$interval)
mean_steps <- activity %>% na.omit() %>% group_by(interval) %>% summarise(interval_steps=mean(steps))
mean_steps[which(mean_steps$interval_steps==max(mean_steps$interval_steps)),]
imputed_activity<-t(apply(activity,1,function(x){
if (is.na(x[1])){
print(x)
ind=which(x[3]==mean_steps$interval)
x[1]=round(mean_steps$interval_steps[ind])
}
return(x)
}
))
imputed_activity=as.data.frame(imputed_activity)
class(imputed_activity$steps)="numeric"
apply(imputed_activity,2,function(x){
sum(is.na(x))
})
summary(imputed_activity$steps)
summary(activity$steps)
imputed_activity<-t(apply(activity,1,function(x){
if (is.na(x[1])){
ind=which(x[3]==mean_steps$interval)
print(class(x[1]))
x[1]=round(mean_steps$interval_steps[ind])
}
return(x)
}
))
class(mean_steps$interval)
imputed_activity<-apply(activity,1,function(x){
if (x[1]=="NA"){
ind=which(x[3]==mean_steps$interval)
x[1]=round(mean_steps$interval_steps[ind])
}
return(x)
}
)
imputed_activity<-apply(activity,1,function(x){
print(x)
if (x[1]=="NA"){
ind=which(x[3]==mean_steps$interval)
x[1]=round(mean_steps$interval_steps[ind])
}
return(x)
}
)
imputed_activity<-apply(activity,1,function(x){
print(x)
print(class(x))
print(class(x[1]))
if (x[1]=="NA"){
ind=which(x[3]==mean_steps$interval)
x[1]=round(mean_steps$interval_steps[ind])
}
return(x)
}
)
imputed_activity<-apply(activity,1,function(x){
print(x)
print(class(x))
print(class(x[1]))
print(x[1])
if (x[1]=="NA"){
ind=which(x[3]==mean_steps$interval)
x[1]=round(mean_steps$interval_steps[ind])
}
return(x)
}
)
imputed_activity<-apply(activity,1,function(x){
print(x)
print(x[1])
print(is.na(x[1]))
if (x[1]=="NA"){
ind=which(x[3]==mean_steps$interval)
x[1]=round(mean_steps$interval_steps[ind])
}
return(x)
}
)
imputed_activity=as.data.frame(t(imputed_activity))
imputed_activity<-apply(activity,1,function(x){
if (is.na(x[1])){
ind=which(x[3]==mean_steps$interval)
x[1]=round(mean_steps$interval_steps[ind])
}
return(x)
}
)
imputed_activity=as.data.frame(t(imputed_activity))
View(imputed_activity)
class(imputed_activity$steps)="numeric"
apply(imputed_activity,2,function(x){
sum(is.na(x))
})
summary(imputed_activity$steps)
summary(activity$steps)
which(mean_steps$interval_steps==max(mean_steps$interval_steps))
imputed_activity<-apply(activity[100:104],1,function(x){
print(x)
if (is.na(x[1])){
ind=which(x[3]==mean_steps$interval)
x[1]=round(mean_steps$interval_steps[ind])
}
return(x)
}
)
imputed_activity<-apply(activity[100:104,],1,function(x){
print(x)
if (is.na(x[1])){
ind=which(x[3]==mean_steps$interval)
x[1]=round(mean_steps$interval_steps[ind])
}
return(x)
}
)
activity[100:104,]
which(mean_steps$interval_steps==max(mean_steps$interval_steps))
which(activity$steps==max(activity$steps))
max(activity$steps)
which(activity$steps==806)
activity[800:810,]
summary(activity$steps)
which(activity$steps>800)
activity$steps[3277]
activity$steps[16492]
imputed_activity<-apply(activity[16490:16500,],1,function(x){
print(x)
if (is.na(x[1])){
ind=which(x[3]==mean_steps$interval)
x[1]=round(mean_steps$interval_steps[ind])
}
return(x)
}
)
imputed_activity<-apply(activity[16490:16500,],1,function(x){
print(x)
if (is.na(x[1])){
print(x)
ind=which(x[3]==mean_steps$interval)
x[1]=round(mean_steps$interval_steps[ind])
}
return(x)
}
)
imputed_activity<-apply(activity[16490:16500,],1,function(x){
if (is.na(x[1])){
print(x)
ind=which(x[3]==mean_steps$interval)
x[1]=round(mean_steps$interval_steps[ind])
}
return(x)
}
)
imputed_activity
activity
summary(activity)
class(activity)
class(activity[,1])
class(activity[,2])
class(activity[,3])
?na.approx
??na.approx
library(zoo)
?na.approx
imputed_activity<-apply(activity,1,function(x){
# if (is.na(x[1])){
print(x)
ind=which(x[3]==mean_steps$interval)
x[1]=mean_steps$interval_steps[ind]
# }
return(x)
}
)
imputed_activity<-apply(activity,1,function(x){
# if (is.na(x[1])){
ind=which(x[3]==mean_steps$interval)
x[1]=mean_steps$interval_steps[ind]
# }
return(x)
}
)
?mapply
View(imputed_activity)
imputed_activity<-apply(activity,1,function(x){
if (!is.na(x[1])){
return(x)
} else {
ind=which(x[3]==mean_steps$interval)
x[1]=mean_steps$interval_steps[ind]
return(x)
}
}
)
imputed_activity=as.data.frame(t(imputed_activity))
class(imputed_activity$steps)="numeric"
apply(imputed_activity,2,function(x){
sum(is.na(x))
})
summary(imputed_activity$steps)
summary(activity$steps)
imputed_activity<-apply(activity[1:300,],1,function(x){
if (!is.na(x[1])){
return(x)
} else {
ind=which(x[3]==mean_steps$interval)
x[1]=mean_steps$interval_steps[ind]
}
return(x)
}
)
imputed_activity
imputed_activity=as.data.frame(t(imputed_activity))
imputed_activity
imputed_activity<-apply(activity[1:300,],1,function(x){
if (is.na(x[1])){
ind=which(x[3]==mean_steps$interval)
x[1]=mean_steps$interval_steps[ind]
}
return(x)
}
)
imputed_activity=as.data.frame(t(imputed_activity))
imputed_activity
summary(imputed_activity$steps)
class(imputed_activity$steps)="numeric"
summary(imputed_activity$steps)
imputed_activity$steps
(imputed_activity$steps)
class(imputed_activity$steps)
imputed_activity<-apply(activity[1:300,],1,function(x){
if (is.na(x[1])){
ind=which(x[3]==mean_steps$interval)
x[1]=round(mean_steps$interval_steps[ind])
}
return(x)
}
)
imputed_activity
imputed_activity=as.data.frame(t(imputed_activity))
imputed_activity
class(imputed_activity$steps)
imputed_activity$steps=as.numeric(imputed_activity$steps)
imputed_activity
imputed_activity<-apply(activity[1:300,],1,function(x){
if (is.na(x[1])){
ind=which(x[3]==mean_steps$interval)
x[1]=round(mean_steps$interval_steps[ind])
}
return(x)
}
)
imputed_activity=as.data.frame(t(imputed_activity))
imputed_activity
summary(imputed_activity$steps)
imputed_activity$steps=as.numeric(imputed_activity$steps)
imputed_activity
imputed_activity<-apply(activity[1:300,],1,function(x){
if (is.na(x[1])){
ind=which(x[3]==mean_steps$interval)
x[1]=round(mean_steps$interval_steps[ind])
}
return(x)
}
)
imputed_activity=as.data.frame(t(imputed_activity))
imputed_activity
class(imputed_activity$steps)
as.factor(0)
as.numeric(as.factor(0))
imputed_activity<-apply(activity[1:300,],1,function(x){
if (is.na(x[1])){
ind=which(x[3]==mean_steps$interval)
x[1]=round(mean_steps$interval_steps[ind])
}
return(x)
}
)
imputed_activity=as.data.frame(t(imputed_activity))
imputed_activity$steps=as.numeric(as.character(imputed_activity$steps))
imputed_activity
apply(imputed_activity,2,function(x){
sum(is.na(x))
})
summary(imputed_activity$steps)
summary(activity$steps)
activity$steps>800
which(activity$steps>800)
imputed_activity<-apply(activity[16490:16500,],1,function(x){
if (is.na(x[1])){
ind=which(x[3]==mean_steps$interval)
x[1]=round(mean_steps$interval_steps[ind])
}
return(x)
}
)
activity[16490:16500,]
imputed_activity=as.data.frame(t(imputed_activity))
imputed_activity
imputed_activity$steps=as.numeric(as.character(imputed_activity$steps))
imputed_activity
summary(imputed_activity$steps)
summary(activity$steps)
imputed_activity<-apply(activity,1,function(x){
if (is.na(x[1])){
ind=which(x[3]==mean_steps$interval)
}
x[1]=round(mean_steps$interval_steps[ind])
return(x)
}
imputed_activity=as.data.frame(t(imputed_activity))
)
imputed_activity$steps=as.numeric(as.character(imputed_activity$steps))
apply(imputed_activity,2,function(x){
sum(is.na(x))
})
imputed_activity<-apply(activity,1,function(x){
if (is.na(x[1])){
ind=which(x[3]==mean_steps$interval)
x[1]=round(mean_steps$interval_steps[ind])
}
return(x)
}
)
imputed_activity=as.data.frame(t(imputed_activity))
imputed_activity$steps=as.numeric(as.character(imputed_activity$steps))
apply(imputed_activity,2,function(x){
sum(is.na(x))
})
summary(imputed_activity$steps)
summary(activity$steps)
imputed_sum_steps <- imputed_activity %>% group_by(date) %>% summarise(daily_steps=sum(steps))
ggplot(imputed_sum_steps,aes(x=daily_steps))+geom_histogram()+theme_bw()+
xlab("Daily Steps")+ggtitle("Imputed Total Daily Steps")
ggplot(sum_steps,aes(x=daily_steps))+geom_histogram()+theme_bw()+
xlab("Daily Steps")+ggtitle("Total Daily Steps")
imputed_sum_steps %>%   na.omit()  %>% summarise(mean(daily_steps),median(daily_steps))
imputed_sum_steps
imputed_sum_steps %>%   na.omit()  %>% summarise(mean(daily_steps),median(daily_steps))
sum_steps %>%   na.omit()  %>% summarise(mean(daily_steps),median(daily_steps))
imputed_sum_steps %>%   na.omit()  %>% summarise(mean(daily_steps),median(daily_steps))
sum_steps %>%   na.omit()  %>% summarise(mean(daily_steps),median(daily_steps))
class(activity$date)
as.POSIXct(activity$date[1:10])
activity$date[1:10]
activity$date=as.POSIXct(activity$date)
?weekdays
weekdays(activity$date[1:10])
week_break <- function(date) {
day <- weekdays(date)
if (day %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday")){
return("Weekday")
}
else { (day %in% c("Saturday", "Sunday"))
return("Weekend")
}
}
imputed_activity$date=as.POSIXct(activity$date)
imputed_activity
View(imputed_activity)
activity$week_break<-sapply(imputed_activity$date,FUN=week_break)
imputed_activity$week_break<-sapply(imputed_activity$date,FUN=week_break)
View(imputed_activity)
ggplot(imputed_sum_steps,aes(x=daily_steps))+geom_histogram()+theme_bw()+
xlab("Daily Steps")+ggtitle("Imputed Total Daily Steps") +geom_facet(.~week_break)
ggplot(imputed_sum_steps,aes(x=daily_steps))+geom_histogram()+theme_bw()+
xlab("Daily Steps")+ggtitle("Imputed Total Daily Steps") +facet_grid(.~week_break)
ggplot(imputed_activity,aes(x=daily_steps))+geom_histogram()+theme_bw()+
xlab("Daily Steps")+ggtitle("Imputed Total Daily Steps") +facet_grid(.~week_break)
imputed_sum_steps_weekday <- imputed_activity %>% group_by(week_break) %>% summarise(daily_steps=sum(steps))
imputed_sum_steps_weekday
imputed_sum_steps_weekday <- imputed_activity %>% group_by(date,week_break) %>% summarise(daily_steps=sum(steps))
imputed_sum_steps_weekday
ggplot(activity,aes(x=interval,y=steps))+geom_point()+geom_smooth(aes(group=1))+
xlab("Interval")+ylab("Steps")+ggtitle("Total Daily Steps")
ggplot(imputed_activity,aes(x=interval,y=steps))+geom_point()+geom_smooth(aes(group=1))+
xlab("Interval")+ylab("Steps")+ggtitle("Total Daily Steps")+facet_grid(.~week_break)
ggplot(imputed_activity,aes(x=interval,y=steps))+geom_point()+geom_smooth(aes(group=1))+
xlab("Interval")+ylab("Steps")+ggtitle("Total Daily Steps")+facet_grid(week_break~.)
storm <- tbl_df(read.csv(bzfile("data/repdata-data-StormData.csv.bz2")))
library(ggplot2)
library(tidyr)
library(dplyr)
library(zoo)
storm <- tbl_df(read.csv(bzfile("data/repdata-data-StormData.csv.bz2")))
?bzfile
storm <- read.csv(bzfile("data/repdata-data-StormData.csv.bz2"))
storm <- read.csv(("data/repdata-data-StormData.csv"))
storm <- read.csv(bzfile("repdata-data-StormData.csv.bz2"))
storm <- tbl_df(storm)
storm
summary(storm)
names(storm)
class(storm$EVTYPE)
?storm
library(devtools)
library(ggplot2)
library(tidyr)
library(zoo)
library(dplyr)
activity<-tbl_df(read.csv(unzip("./activity.csv")))
activity<-tbl_df(read.csv(("./activity.csv")))
ls()
list.files()
activity<-tbl_df(read.csv(unzip("./repdata-data-activity.zip")))
activity
summary(activity)
names(activity)
length(unique(activity$date))
View(activity)
activity<-tbl_df(read.csv(unzip("./repdata-data-activity.zip")))
activity
summary(activity)
names(activity)
length(unique(activity$date))
sum_steps <- activity %>% group_by(date) %>% summarise(daily_steps=sum(steps))
sum_steps
ggplot(sum_steps,aes(x=daily_steps))+geom_histogram()+theme_bw()+
xlab("Daily Steps")+ggtitle("Total Daily Steps")
sum_steps %>%   na.omit()  %>% summarise(mean(daily_steps),median(daily_steps))
ggplot(activity,aes(x=interval,y=steps))+geom_point()+geom_smooth(aes(group=1))+
xlab("Interval")+ylab("Steps")+ggtitle("Total Daily Steps")
activity$interval=as.factor(activity$interval)
mean_steps <- activity %>% na.omit() %>% group_by(interval) %>% summarise(interval_steps=mean(steps))
mean_steps[which(mean_steps$interval_steps==max(mean_steps$interval_steps)),]
apply(activity,2,function(x){
sum(is.na(x))
})
imputed_activity<-apply(activity,1,function(x){
if (is.na(x[1])){
ind=which(x[3]==mean_steps$interval)
x[1]=round(mean_steps$interval_steps[ind])
}
return(x)
}
)
imputed_activity=as.data.frame(t(imputed_activity))
imputed_activity$steps=as.numeric(as.character(imputed_activity$steps))
apply(imputed_activity,2,function(x){
sum(is.na(x))
})
summary(imputed_activity$steps)
summary(activity$steps)
imputed_sum_steps <- imputed_activity %>% group_by(date) %>% summarise(daily_steps=sum(steps))
ggplot(imputed_sum_steps,aes(x=daily_steps))+geom_histogram()+theme_bw()+
xlab("Daily Steps")+ggtitle("Imputed Total Daily Steps")
imputed_sum_steps %>%   na.omit()  %>% summarise(mean(daily_steps),median(daily_steps))
sum_steps %>%   na.omit()  %>% summarise(mean(daily_steps),median(daily_steps))
imputed_activity$date=as.POSIXct(activity$date)
week_break <- function(date) {
day <- weekdays(date)
if (day %in% c("Monday", "Tuesday", "Wednesday", "Thursday", "Friday")){
return("Weekday")
}
else { (day %in% c("Saturday", "Sunday"))
return("Weekend")
}
}
imputed_activity$week_break<-sapply(imputed_activity$date,FUN=week_break)
imputed_activity
imputed_sum_steps_weekday <- imputed_activity %>% group_by(date,week_break) %>% summarise(daily_steps=sum(steps))
ggplot(imputed_activity,aes(x=interval,y=steps))+geom_point()+geom_smooth(aes(group=1))+
xlab("Interval")+ylab("Steps")+ggtitle("Total Daily Steps")+facet_grid(week_break~.)
sum_steps %>%   na.omit()  %>% summarise(Mean_Daily_Steps=mean(daily_steps),Median_Daily_Steps=median(daily_steps))
print(sum_steps %>%   na.omit()  %>% summarise(Mean_Daily_Steps=mean(daily_steps),Median_Daily_Steps=median(daily_steps)))
print(sum_steps %>%   na.omit()  %>% summarise(mean(daily_steps),median(daily_steps)) )
print(sum_steps %>%   na.omit()  %>% summarise(Mean_Daily_Steps=mean(daily_steps),Median_Daily_Steps=median(daily_steps)) )
```
sum_steps %>%   na.omit()  %>% summarise(Mean_Daily_Steps=mean(daily_steps),Median_Daily_Steps=median(daily_steps))
print(sum_steps %>%   na.omit()  %>% summarise(Mean_Daily_Steps=mean(daily_steps),Median_Daily_Steps=median(daily_steps)) )
print(sum_steps %>%   na.omit()  %>% summarise(Mean_Daily_Steps=mean(daily_steps),Median_Daily_Steps=median(daily_steps)) )
```
